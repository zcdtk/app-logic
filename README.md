# 应用逻辑简介

app 中，开发人员常常将业务处理内容封装成方法，方便开发和维护。这些被封装的方法，是 app 具体业务数据处理逻辑。不同的逻辑内容，体现了不同功能业务需求和交互设计需求。

iBiz 前端模型，将此类具有公共业务需求的数据处理过程对象化，一同构成了应用逻辑的全部内容。

## 逻辑内容

在 iBiz 前端模型中，逻辑的构成是一个中性的结构模型。通过业务配置，将逻辑放入载体（视图、部件）中后，逻辑业务需求才通过结构代码块得到表现，这些代码块包含了业务逻辑模型全部内容。

因此，iBiz 定义逻辑模型，在具体的 app 中实现业务逻辑。

应用逻辑主要模型对象构成如下：

| 模型名称 | 详情                                                         | 备注 |
| -------- | ------------------------------------------------------------ | ---- |
| 界面逻辑 | [ IPSViewLogic](https://modelapi.ibizlab.cn/#/net/ibizsys/model/view/IPSViewLogic) |      |
| 界面行为 | [ IPSUIAction](https://modelapi.ibizlab.cn/#/net/ibizsys/model/view/IPSUIAction) |      |
| 界面引擎 | [IPSUIEngine](https://modelapi.ibizlab.cn/#/net/ibizsys/model/res/IPSUIEngine) |      |

### 事件

> 注：从模型组成来讲，逻辑事件属于逻辑的一部分，它不具备单独的模型能力，此处将它单独列为一个小节，是为了方便理解。

事件是用逻辑内的一个节点，这个节点提供界面处理入口、数据对象数据处理与数据交互等功能，事件主要分为部件事件、逻辑事件和引擎事件。

#### 部件事件

部件事件是界面处理的入口，iBiz 前端将 app 操作界面事件的业务模型构建在部件逻辑内管理，使部件成为界面处理的入口。

部件的界面行为逻辑包含逻辑事件，其业务逻辑模型在发布后，使其成为统一入口。例如，工具栏部件成员支持的界面行为，表单部件按钮成员支持的界面行为，表格部件操作列支持的界面行为。

#### 逻辑事件

逻辑事件主要是分发处理部件事件，其主要功能是从被指定的容器对象中获取数据，交给后续界面行为使用。

容器对象分别是视图和部件，两者的区别在于是在当前操作的 [控件容器]( https://modelapi.ibizlab.cn/#/net/ibizsys/model/control/IPSControlContainer ) 是否与 [部件数据容器]( https://modelapi.ibizlab.cn/#/net/ibizsys/model/control/IPSControlXDataContainer )  为同一个对象。

如果两个对象一致，则直接从该逻辑事件载体是部件，直接从部件获取数据；如果两个对象不一致，则该部件事件载体是视图，视图需要从对应的部件中获取数据。

界面行为业务模型被使用时，会自动判断逻辑事件指定的数据对象，逻辑事件代码会从数据对象获取数据，完成分发部件事件的过程。

#### 引擎事件

引擎事件是 iBiz 事件中比较特殊的一类，它的定义在 iBiz 界面引擎类型内，使用在 app 核心引擎中。

iBiz 模型预置对应视图的界面引擎类型，这些界面引擎包含的部件指定事件名称，iBiz V2 发布逻辑解析对应的参数名称到部件事件中，成为部件事件，提供给部件与视图作为数据交互的节点。

部件与视图之间做数据交互，部件对外提交数据，视图内对应的部件事件接收数据，再由部件事件转发进入核心引擎，执行预置引擎逻辑。

常见的引擎事件有数据加载完成、数据删除完成和数据保存完成等，它们既包含数据对象的操作状态和数据状态传递。

### 行为逻辑



行为是应用逻辑的最终执行单位，应用逻辑经过一些列流程达到行为时，已经为行为提供了明确的数据，行为需要根据其自身定义，使用数据完成业务需求。

行为多种多样的，由预置的行为，

### 预置逻辑



### 引擎逻辑

引擎是 app 运行的核心逻辑，在视图的运行中，iBiz 对一些常规的视图，提供预置的逻辑处理。例如，视图参数处理、部件初始化顺序、部件事件之间的管理以及集成预置界面行为等。

作为 app 内视图运行核心的一部分， iBiz 模型针对每个不同类别的视图，定义不同的视图引擎标识。这些引擎标识指定了视图名称、视图参数（引擎事件）和成员部件，在每个业务视图文件内，将这些视图预置逻辑构建发布在视图中，成为抽象业务模型的核心运行层。

观察引擎逻辑，主要理解以下几个方面：

- 交互：部件与视图的事件交互
- 引擎事件：监控事件及其处理内容
- 行为：触发预置行为

## 逻辑结构



## 触发流程

{% mermaid %}
graph TD;
  A-->B;
  A-->C;
  B-->D;
  C-->D;
{% endmermaid %}